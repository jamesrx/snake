!function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){},function(e,t,i){"use strict";i.r(t);var s=Object.freeze({BOARD:"BOARD",FOOD:"FOOD",SNAKE:"SNAKE"});var r=class{constructor(e,t,i){this.x=e,this.y=t,this.type=i||s.BOARD}};var n=class{constructor(e,t,i){this.width=e,this.height=t,this.pixelSize=20,this.pixels={};const s=document.createElement("canvas");s.width=e,s.height=t,i.appendChild(s),this.ctx=s.getContext("2d")}draw(){this.ctx.fillStyle="#85ca00",this.ctx.fillRect(0,0,this.width,this.height),Object.values(this.pixels).forEach(e=>{Object.values(e).forEach(e=>{this.ctx.fillStyle=e.color,this.ctx.fillRect(e.x*this.pixelSize,e.y*this.pixelSize,this.pixelSize,this.pixelSize)})})}addPixels(...e){e.forEach(e=>{this.pixels[e.x]=this.pixels[e.x]||{},this.pixels[e.x][e.y]=e})}findEmptyPixel(){const e=[];for(let t=0;t<this.width/this.pixelSize;t++)for(let i=0;i<this.height/this.pixelSize;i++){let s=new r(t,i);this.pixels[t]&&this.pixels[t][i]||e.push(s)}return e[Math.floor(Math.random()*e.length)]}getPixel(e){return this.pixels[e.x]&&this.pixels[e.x][e.y]||e}clearPixel(e){delete this.pixels[e.x][e.y],Object.keys(this.pixels[e.x]).length||delete this.pixels[e.x]}isOutOfBounds(e){return e.x<0||e.y<0||e.x*this.pixelSize>=this.width||e.y*this.pixelSize>=this.height}};var h=class{constructor(e){return e.color="#ff0000",e.type=s.FOOD,e}};var o=Object.freeze({LEFT:"LEFT",UP:"UP",RIGHT:"RIGHT",DOWN:"DOWN"});var a=Object.freeze({37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"});var c=class{constructor(e){this.pixels=[],this.head=null,this.direction=null,this.nextDirection="",this.addHead(e),document.addEventListener("keydown",this.setNextDirection.bind(this))}addHead(e){e.color="#000",e.type=s.SNAKE,this.pixels.push(e),this.head=e}setNextDirection(e){const t=o[a[e.keyCode]];t&&(this.nextDirection=t)}findMove(){this.direction===o.LEFT&&this.nextDirection===o.RIGHT||this.direction===o.RIGHT&&this.nextDirection===o.LEFT||this.direction===o.UP&&this.nextDirection===o.DOWN||this.direction===o.DOWN&&this.nextDirection===o.UP||(this.direction=this.nextDirection);let e=this.head.x,t=this.head.y;switch(this.direction){case o.LEFT:e--;break;case o.UP:t--;break;case o.RIGHT:e++;break;case o.DOWN:t++}return new r(e,t)}removeTail(){return this.pixels.shift()}};var l=class{constructor(e,t,i){this.containerEl=document.getElementById("game-container"),this.scoreEl=document.querySelector(".current-score"),this.highScoreEl=document.querySelector(".high-score"),this.gameOverEl=document.querySelector(".game-over"),this.board=new n(e,t,document.getElementById("board-container")),this.fps=i,this.point_value=100,this.GAME_OVER_CLASS="game-container--game-over",this.HIGH_SCORE_CLASS="game-over--high-score",document.querySelector(".game-over__play-again-btn").addEventListener("click",()=>this.start())}start(){this.containerEl.classList.remove(this.GAME_OVER_CLASS),this.gameOverEl.classList.remove(this.HIGH_SCORE_CLASS),this.score=0,this.highScore=localStorage.getItem("highScore")||0,this.board.pixels={},this.snake=new c(this.board.findEmptyPixel()),this.board.addPixels(new h(this.board.findEmptyPixel()),...this.snake.pixels),this.board.draw(),this.scoreEl.innerText=this.score,this.highScoreEl.innerText=this.highScore,this.startAnimation()}startAnimation(){let e=Date.now();const t=1e3/this.fps,i=()=>{this.animationId=requestAnimationFrame(i);const s=Date.now(),r=s-e;r>t&&(e=s-r%t,this.updateFrame())};i()}updateFrame(){if(this.snake.nextDirection){const e=this.board.getPixel(this.snake.findMove());if(this.board.isOutOfBounds(e)||e.type===s.SNAKE)return this.gameOver(),!1;e.type===s.FOOD?(this.score+=this.point_value,this.scoreEl.innerText=this.score,this.board.addPixels(new h(this.board.findEmptyPixel()))):this.board.clearPixel(this.snake.removeTail()),this.snake.addHead(e),this.board.addPixels(...this.snake.pixels),this.board.draw()}}gameOver(){cancelAnimationFrame(this.animationId),this.score>this.highScore&&(localStorage.setItem("highScore",this.score),this.gameOverEl.classList.add(this.HIGH_SCORE_CLASS)),this.containerEl.classList.add(this.GAME_OVER_CLASS)}};i(0);new l(500,400,12).start()}]);